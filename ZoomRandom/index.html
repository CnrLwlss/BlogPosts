<!DOCTYPE doctype html>

<html lang="en">
<head><title>Zoom on a Random Walk</title>
<meta charset="utf-8">

<meta content="" name="description"/>
<link href="../CLstyle.css" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
</link></link></meta></head>

<div id = "banner">
<a href="http://cnr.lwlss.net">
<div style="display:inline-block; align: center;vertical-align: middle;" >
  <img src="../logo.png" style="height:150px; padding-right: 20px;">
</div>
<div style="display:inline-block;vertical-align: middle;">
  <h1 style="margin-top:-10; margin-bottom:-10;">Conor Lawless</h1>
  <h2 style="margin-top:-10; margin-bottom:-10;">Scientific Computing</h2>
  <h3 style="margin-top:-10; margin-bottom:-10;">http://cnr.lwlss.net</h3>
</div>
</a>
</div>


<body><header><h1>Zoom on a Random Walk</h1><time datetime="2009-12-06T22:33:00Z">22:33 Sunday 6th December 2009</time></header><article>After reading <a href="http://www.staff.ncl.ac.uk/d.j.wilkinson/">Darren's</a> <a href="http://darrenjw.posterous.com/basic-mandelbrot-set-in-r">post about the Mandelbrot set</a> I was browsing through the <a href="http://en.wikipedia.org/wiki/Mandelbrot_set">Wikipedia entry on the Mandelbrot set</a> which has a few amazing animations of really deep zooms on the fractal bounded by the set.
<br/>
<br/>The good/bad thing about fractals is that as you magnify them, the pattern and resulting image that you see is in some way similar to patterns you saw at lower magnifications.  So the zooms are in some sense self-similar.
<br/>
<br/>It occurred to me that viewing random walks at different magnifications should have a similar property.  You should not be able to tell what magnification you are looking at, since the average trajectory should be random, regardless of the scale of the trajectory.  As long as you are away from the scale at which you can observe any discrete steps making up the walk, that is.
<br/>
<br/>So, we should be able to make semi-infinite zooms of random walks, in which all magnifications look believably random and as if they were generated from the same process but without any repeating or recurring patterns.  I think the random walks are quite pleasing to look at.  It is a bit tricky to create this zoom though, since I can't think of any cunning way to step from one magnification to another by "filling in" the gaps in the walk that have just come into view.  So I have to create a massive random walk image, and progressively resize and crop it to achieve the zoom.  Also, the <a href="http://www.pygame.org">PyGame</a> code I <a href="http://cnr.lwlss.net/RandomWalks">posted</a> a while ago is too slow for generating a massive random walk.  However, there's no need to see the walk being generated in this case, so we can just colour pixels black and anti-alias during image resize (using the <a href="http://www.pythonware.com/products/pil/">Python Imaging Library</a>) instead of doing it in real-time.
<br/>
<br/>Deep zooming is cool anyway as you can see in the amazing <a href="http://www.youtube.com/watch?v=A2cmlhfdxuY">Powers of Ten</a> video by <a href="http://en.wikipedia.org/wiki/Charles_and_Ray_Eames">Charles and Ray Eames</a>.
<br/>
<br/>So, here's a zoom on a random walk that I made (approximately 100 times zoom, made on a 32-bit machine with 3.5Gb RAM):
<br/>
<br/><center><img alt="Zoom on a Random Walk" src="http://lwlss.net/RandZoom1.gif"/></center>
<br/>
<br/>The frames were generated with the <a href="http://python.org">Python</a> code below.  If you have a more powerful computer than me to hand, you can generate a deeper zoom!  Just increase the width and height parameters until you run out of memory or patience.  I patched the output images together and created a .gif animation using the amazing <a href="http://www.virtualdub.org/">VirtualDub</a>.
<br/>
<br/><pre><font face="Lucida,Courier New"><font color="#C00000">import</font> <font color="#000000">PIL</font><font color="#0000C0">,</font><font color="#000000">random</font><font color="#0000C0">,</font><font color="#000000">math</font><font color="#0000C0">,</font><font color="#000000">os</font>
<br/><font color="#C00000">from</font> <font color="#000000">PIL</font> <font color="#C00000">import</font> <font color="#000000">Image</font><font color="#0000C0">,</font><font color="#000000">ImageDraw</font>
<br/> 
<br/><font color="#008000"># Define screen size and initialize
<br/></font><font color="#000000">size</font><font color="#0000C0">=</font><font color="#000000">width</font><font color="#0000C0">,</font><font color="#000000">height</font><font color="#0000C0">=</font><font color="#0080C0">3500</font><font color="#0000C0">,</font><font color="#0080C0">3500</font>
<br/><font color="#000000">plot</font><font color="#0000C0">=</font><font color="#000000">Image</font><font color="#0000C0">.</font><font color="#000000">new</font><font color="#0000C0">(</font><font color="#004080">"L"</font><font color="#0000C0">,</font><font color="#0000C0">(</font><font color="#000000">width</font><font color="#0000C0">,</font><font color="#000000">height</font><font color="#0000C0">)</font><font color="#0000C0">,</font><font color="#004080">'white'</font><font color="#0000C0">)</font>
<br/><font color="#000000">pix</font><font color="#0000C0">=</font><font color="#000000">plot</font><font color="#0000C0">.</font><font color="#000000">load</font><font color="#0000C0">(</font><font color="#0000C0">)</font>
<br/> 
<br/><font color="#008000"># Output Frame size
<br/></font><font color="#000000">wf</font><font color="#0000C0">,</font><font color="#000000">hf</font><font color="#0000C0">=</font><font color="#0080C0">250</font><font color="#0000C0">,</font><font color="#0080C0">250</font>
<br/><font color="#008000"># Zoom parameters
<br/></font><font color="#000000">zmax</font><font color="#0000C0">,</font><font color="#000000">zno</font><font color="#0000C0">=</font><font color="#0080C0">1.0</font><font color="#0000C0">,</font><font color="#0080C0">700</font>
<br/> 
<br/><font color="#008000"># Start at centre of image
<br/></font><font color="#000000">x</font><font color="#0000C0">,</font><font color="#000000">y</font><font color="#0000C0">=</font><font color="#000000">width</font><font color="#0000C0">/</font><font color="#0080C0">2</font><font color="#0000C0">,</font><font color="#000000">height</font><font color="#0000C0">/</font><font color="#0080C0">2</font>
<br/><font color="#000000">pix</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">,</font><font color="#000000">y</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#0080C0">0</font>
<br/> 
<br/><font color="#008000"># Prepare to find the bounding box for the walk
<br/></font><font color="#000000">xmin</font><font color="#0000C0">,</font><font color="#000000">ymin</font><font color="#0000C0">,</font><font color="#000000">xmax</font><font color="#0000C0">,</font><font color="#000000">ymax</font><font color="#0000C0">=</font><font color="#000000">x</font><font color="#0000C0">,</font><font color="#000000">y</font><font color="#0000C0">,</font><font color="#000000">x</font><font color="#0000C0">,</font><font color="#000000">y</font>
<br/><font color="#000000">pcount</font><font color="#0000C0">=</font><font color="#0080C0">0</font>
<br/> 
<br/><font color="#008000"># Start walking until we hit the edge
<br/></font><font color="#C00000">while</font> <font color="#0080C0">1</font><font color="#0000C0">&lt;=</font><font color="#000000">x</font><font color="#0000C0">&lt;</font><font color="#000000">width</font><font color="#0000C0">-</font><font color="#0080C0">1</font> <font color="#C00000">and</font> <font color="#0080C0">1</font><font color="#0000C0">&lt;=</font><font color="#000000">y</font><font color="#0000C0">&lt;</font><font color="#000000">height</font><font color="#0000C0">-</font><font color="#0080C0">1</font><font color="#0000C0">:</font>
<br/>        <font color="#008000"># Generate new steps
<br/></font>        <font color="#000000">xnew</font><font color="#0000C0">=</font><font color="#000000">x</font><font color="#0000C0">+</font><font color="#000000">random</font><font color="#0000C0">.</font><font color="#000000">randint</font><font color="#0000C0">(</font><font color="#0000C0">-</font><font color="#0080C0">1</font><font color="#0000C0">,</font><font color="#0080C0">1</font><font color="#0000C0">)</font>
<br/>        <font color="#000000">ynew</font><font color="#0000C0">=</font><font color="#000000">y</font><font color="#0000C0">+</font><font color="#000000">random</font><font color="#0000C0">.</font><font color="#000000">randint</font><font color="#0000C0">(</font><font color="#0000C0">-</font><font color="#0080C0">1</font><font color="#0000C0">,</font><font color="#0080C0">1</font><font color="#0000C0">)</font>
<br/>        <font color="#000000">x</font><font color="#0000C0">,</font><font color="#000000">y</font><font color="#0000C0">=</font><font color="#000000">xnew</font><font color="#0000C0">,</font><font color="#000000">ynew</font>
<br/>        <font color="#000000">pix</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">,</font><font color="#000000">y</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#0080C0">0</font>
<br/>        <font color="#000000">pcount</font><font color="#0000C0">+=</font><font color="#0080C0">1</font>
<br/>        <font color="#C00000">if</font> <font color="#000000">x</font><font color="#0000C0">&lt;</font><font color="#000000">xmin</font><font color="#0000C0">:</font><font color="#000000">xmin</font><font color="#0000C0">=</font><font color="#000000">x</font>
<br/>        <font color="#C00000">if</font> <font color="#000000">x</font><font color="#0000C0">&gt;</font><font color="#000000">xmax</font><font color="#0000C0">:</font><font color="#000000">xmax</font><font color="#0000C0">=</font><font color="#000000">x</font>
<br/>        <font color="#C00000">if</font> <font color="#000000">y</font><font color="#0000C0">&lt;</font><font color="#000000">ymin</font><font color="#0000C0">:</font><font color="#000000">ymin</font><font color="#0000C0">=</font><font color="#000000">y</font>
<br/>        <font color="#C00000">if</font> <font color="#000000">y</font><font color="#0000C0">&gt;</font><font color="#000000">ymax</font><font color="#0000C0">:</font><font color="#000000">ymax</font><font color="#0000C0">=</font><font color="#000000">y</font>
<br/> 
<br/><font color="#008000"># Crop to the walk      
<br/></font><font color="#000000">plot</font><font color="#0000C0">=</font><font color="#000000">plot</font><font color="#0000C0">.</font><font color="#000000">crop</font><font color="#0000C0">(</font><font color="#0000C0">(</font><font color="#000000">xmin</font><font color="#0000C0">,</font><font color="#000000">ymin</font><font color="#0000C0">,</font><font color="#000000">xmax</font><font color="#0000C0">,</font><font color="#000000">ymax</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/> 
<br/><font color="#008000"># Rotate if necessary to make image wider than tall
<br/></font><font color="#C00000">if</font> <font color="#000000">xmax</font><font color="#0000C0">-</font><font color="#000000">xmin</font><font color="#0000C0">&lt;</font><font color="#000000">ymax</font><font color="#0000C0">-</font><font color="#000000">ymin</font><font color="#0000C0">:</font>
<br/>        <font color="#000000">plot</font><font color="#0000C0">=</font><font color="#000000">plot</font><font color="#0000C0">.</font><font color="#000000">rotate</font><font color="#0000C0">(</font><font color="#0080C0">90</font><font color="#0000C0">)</font>
<br/><font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">,</font><font color="#000000">h</font><font color="#0000C0">)</font><font color="#0000C0">=</font><font color="#000000">plot</font><font color="#0000C0">.</font><font color="#000000">size</font>
<br/> 
<br/><font color="#008000"># Set minium zoom to just capture entire walk
<br/></font><font color="#000000">zmin</font><font color="#0000C0">=</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">wf</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">)</font>
<br/> 
<br/><font color="#008000"># For geometric zooming:
<br/></font><font color="#008000"># zoom(z) = a*pow(phi,b*z)
<br/></font><font color="#008000"># insist that zoom(0)=zmin, zoom(zno)=zmax
<br/></font><font color="#000000">phi</font><font color="#0000C0">=</font><font color="#0080C0">10.0</font>
<br/><font color="#000000">a</font><font color="#0000C0">=</font><font color="#000000">zmin</font>
<br/><font color="#000000">b</font><font color="#0000C0">=</font><font color="#000000">math</font><font color="#0000C0">.</font><font color="#000000">log</font><font color="#0000C0">(</font><font color="#000000">zmax</font><font color="#0000C0">/</font><font color="#000000">zmin</font><font color="#0000C0">,</font><font color="#000000">phi</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#000000">zno</font>
<br/> 
<br/><font color="#C00000">for</font> <font color="#000000">z</font> <font color="#C00000">in</font> <font color="#000000">xrange</font><font color="#0000C0">(</font><font color="#0080C0">0</font><font color="#0000C0">,</font><font color="#000000">zno</font><font color="#0000C0">+</font><font color="#0080C0">1</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
<br/>        <font color="#000000">zoom</font><font color="#0000C0">=</font><font color="#000000">a</font><font color="#0000C0">*</font><font color="#000000">pow</font><font color="#0000C0">(</font><font color="#000000">phi</font><font color="#0000C0">,</font><font color="#000000">b</font><font color="#0000C0">*</font><font color="#000000">z</font><font color="#0000C0">)</font>
<br/>        <font color="#C00000">print</font> <font color="#004080">"FRAME: "</font><font color="#0000C0">,</font><font color="#000000">z</font><font color="#0000C0">,</font> <font color="#000000">zoom</font>
<br/>        <font color="#000000">blank</font><font color="#0000C0">=</font><font color="#000000">Image</font><font color="#0000C0">.</font><font color="#000000">new</font><font color="#0000C0">(</font><font color="#004080">"L"</font><font color="#0000C0">,</font><font color="#0000C0">(</font><font color="#000000">wf</font><font color="#0000C0">,</font><font color="#000000">hf</font><font color="#0000C0">)</font><font color="#0000C0">,</font><font color="#004080">'white'</font><font color="#0000C0">)</font>
<br/>        <font color="#C00000">if</font> <font color="#000000">z</font><font color="#0000C0">&gt;</font><font color="#0080C0">0</font> <font color="#C00000">and</font> <font color="#000000">z</font><font color="#0000C0">%</font><font color="#0080C0">50</font><font color="#0000C0">==</font><font color="#0080C0">0</font><font color="#0000C0">:</font>
<br/>                <font color="#008000"># Throw away pixels to achieve deeper zoom with set memory
<br/></font>                <font color="#000000">cz</font><font color="#0000C0">=</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">hf</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">hnew</font><font color="#0000C0">)</font>
<br/>                <font color="#000000">xa</font><font color="#0000C0">=</font><font color="#000000">max</font><font color="#0000C0">(</font><font color="#0080C0">0</font><font color="#0000C0">,</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">-</font><font color="#000000">cz</font><font color="#0000C0">*</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>                <font color="#000000">ya</font><font color="#0000C0">=</font><font color="#000000">max</font><font color="#0000C0">(</font><font color="#0080C0">0</font><font color="#0000C0">,</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">h</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">-</font><font color="#000000">cz</font><font color="#0000C0">*</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">h</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>                <font color="#000000">xb</font><font color="#0000C0">=</font><font color="#000000">min</font><font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">,</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">+</font><font color="#000000">cz</font><font color="#0000C0">*</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>                <font color="#000000">yb</font><font color="#0000C0">=</font><font color="#000000">min</font><font color="#0000C0">(</font><font color="#000000">h</font><font color="#0000C0">,</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">h</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">+</font><font color="#000000">cz</font><font color="#0000C0">*</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">h</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>                <font color="#000000">plot</font><font color="#0000C0">=</font><font color="#000000">plot</font><font color="#0000C0">.</font><font color="#000000">crop</font><font color="#0000C0">(</font><font color="#0000C0">(</font><font color="#000000">xa</font><font color="#0000C0">,</font><font color="#000000">ya</font><font color="#0000C0">,</font><font color="#000000">xb</font><font color="#0000C0">,</font><font color="#000000">yb</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>                <font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">,</font><font color="#000000">h</font><font color="#0000C0">)</font><font color="#0000C0">=</font><font color="#000000">plot</font><font color="#0000C0">.</font><font color="#000000">size</font>
<br/>        <font color="#000000">wnew</font><font color="#0000C0">=</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">zoom</font><font color="#0000C0">*</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">w</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#000000">hnew</font><font color="#0000C0">=</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">zoom</font><font color="#0000C0">*</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">h</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#008000"># Resize the frame
<br/></font>        <font color="#000000">small</font><font color="#0000C0">=</font><font color="#000000">plot</font><font color="#0000C0">.</font><font color="#000000">resize</font><font color="#0000C0">(</font><font color="#0000C0">(</font><font color="#000000">wnew</font><font color="#0000C0">+</font><font color="#0080C0">1</font><font color="#0000C0">,</font><font color="#000000">hnew</font><font color="#0000C0">+</font><font color="#0080C0">1</font><font color="#0000C0">)</font><font color="#0000C0">,</font><font color="#000000">Image</font><font color="#0000C0">.</font><font color="#000000">ANTIALIAS</font><font color="#0000C0">)</font>
<br/>        <font color="#008000"># This crop is to trim grey lines which appear
<br/></font>        <font color="#000000">small</font><font color="#0000C0">=</font><font color="#000000">small</font><font color="#0000C0">.</font><font color="#000000">crop</font><font color="#0000C0">(</font><font color="#0000C0">(</font><font color="#0080C0">1</font><font color="#0000C0">,</font><font color="#0080C0">1</font><font color="#0000C0">,</font><font color="#000000">wnew</font><font color="#0000C0">+</font><font color="#0080C0">1</font><font color="#0000C0">,</font><font color="#000000">hnew</font><font color="#0000C0">+</font><font color="#0080C0">1</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#000000">xmin</font><font color="#0000C0">=</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">wnew</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">-</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">wf</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#000000">ymin</font><font color="#0000C0">=</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">hnew</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">-</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">hf</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#000000">xmax</font><font color="#0000C0">=</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">wnew</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">+</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">wf</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#000000">ymax</font><font color="#0000C0">=</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">hnew</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">+</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">hf</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#C00000">if</font> <font color="#000000">wnew</font><font color="#0000C0">&lt;</font><font color="#000000">wf</font> <font color="#C00000">or</font> <font color="#000000">hnew</font><font color="#0000C0">&lt;</font><font color="#000000">hf</font><font color="#0000C0">:</font>
<br/>                <font color="#000000">frame</font><font color="#0000C0">=</font><font color="#000000">Image</font><font color="#0000C0">.</font><font color="#000000">new</font><font color="#0000C0">(</font><font color="#004080">"L"</font><font color="#0000C0">,</font><font color="#0000C0">(</font><font color="#000000">wf</font><font color="#0000C0">,</font><font color="#000000">hf</font><font color="#0000C0">)</font><font color="#0000C0">,</font><font color="#004080">'white'</font><font color="#0000C0">)</font>
<br/>                <font color="#000000">px</font><font color="#0000C0">=</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">wf</font><font color="#0000C0">-</font><font color="#000000">wnew</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>                <font color="#000000">py</font><font color="#0000C0">=</font><font color="#000000">int</font><font color="#0000C0">(</font><font color="#000000">round</font><font color="#0000C0">(</font><font color="#000000">float</font><font color="#0000C0">(</font><font color="#000000">hf</font><font color="#0000C0">-</font><font color="#000000">hnew</font><font color="#0000C0">)</font><font color="#0000C0">/</font><font color="#0080C0">2.0</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>                <font color="#000000">frame</font><font color="#0000C0">.</font><font color="#000000">paste</font><font color="#0000C0">(</font><font color="#000000">small</font><font color="#0000C0">,</font><font color="#0000C0">(</font><font color="#000000">px</font><font color="#0000C0">,</font><font color="#000000">py</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#C00000">else</font><font color="#0000C0">:</font>
<br/>                <font color="#000000">frame</font><font color="#0000C0">=</font><font color="#000000">small</font><font color="#0000C0">.</font><font color="#000000">crop</font><font color="#0000C0">(</font><font color="#0000C0">(</font><font color="#000000">xmin</font><font color="#0000C0">,</font><font color="#000000">ymin</font><font color="#0000C0">,</font><font color="#000000">xmax</font><font color="#0000C0">,</font><font color="#000000">ymax</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<br/>        <font color="#000000">fname</font><font color="#0000C0">=</font><font color="#004080">"FrameL%05d.png"</font><font color="#0000C0">%</font><font color="#000000">z</font>
<br/>        <font color="#000000">frame</font><font color="#0000C0">.</font><font color="#000000">save</font><font color="#0000C0">(</font><font color="#000000">fname</font><font color="#0000C0">)</font>
<br/> 
<br/><font color="#C00000">print</font> <font color="#004080">"Zoom: "</font><font color="#0000C0">,</font><font color="#0080C0">1.0</font><font color="#0000C0">/</font><font color="#000000">zmin</font>
<br/><font color="#C00000">print</font> <font color="#004080">"Steps: "</font><font color="#0000C0">,</font><font color="#000000">pcount</font><font color="#000000"></font></font></pre>
<br/></article></body>
</html>