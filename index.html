<!doctype html>
<html lang=en> 
<head>
<meta charset=utf-8> 
<title>Some pages by Conor Lawless</title>
<meta name="desciption" content="A home for some very occasional articles I write.  I have a wide range of interests and I won't focus on any area in particular.">
<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="CLstyle.css">
</link></link></meta>
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<header><h1>cnr.lwlss.net</h1>
<p>

<a href="http://www.flickr.com/photos/conchur/5834001048/" title="BlueEye by Conor Lawless, on Flickr"><img src="http://farm6.staticflickr.com/5114/5834001048_7b18b2918f_m.jpg" width="240" height="161" alt="BlueEye"></a>

<a href="http://www.flickr.com/photos/conchur/6195124660/" title="Garden Spider - Araneus diadematus by Conor Lawless, on Flickr"><img src="http://farm7.staticflickr.com/6164/6195124660_c4474c64a4_m.jpg" width="240" height="161" alt="Garden Spider - Araneus diadematus"></a>

<iframe src="http://player.vimeo.com/video/6340145?title=0&amp;byline=0&amp;portrait=0&amp;autoplay=1&amp;loop=1" width="201" height="161" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>

<a href="http://www.flickr.com/photos/conchur/6898444022/" title="Snowtopped by Conor Lawless, on Flickr"><img src="http://farm8.staticflickr.com/7176/6898444022_770d243621_m.jpg" width="240" height="161" alt="Snowtopped"></a>

<a href="http://www.flickr.com/photos/conchur/5658435523/" title="FiveByThree by Conor Lawless, on Flickr"><img src="http://farm6.staticflickr.com/5310/5658435523_c2e43729f1_m.jpg" width="240" height="161" alt="FiveByThree"></a>

<a href="http://www.flickr.com/photos/conchur/2824838621/" title="Chips3 by Conor Lawless, on Flickr"><img src="http://farm4.staticflickr.com/3240/2824838621_f3211fb155_m.jpg" width="240" height="161" alt="Chips3"></a>
</p>

<a href="./AboutConor" title="Much about me!">about...</a>&nbsp; &nbsp; &nbsp;<a href="./Archive" title="Archive of posts, sorted alphabetically">archive...</a>&nbsp; &nbsp; &nbsp;<a href="http://cnr.lwlss.net/rss.xml" title="RSS feed for reading posts using Google Reader for example">RSS feed...</a>
</header>

<article>
	<h1>A discrete, stochastic, logistic population model</h1>
	<time datetime="2012-12-29T18:32:05Z">18:32 Saturday 29th December 2012</time>
	
	<p>In this article, I will present a simple, discrete, stochastic version of the logistic population model and a convenient function for carrying out dynamic simulations from this model.  The discrete, stochastic version of the logistic model is relevant for any growth process initialised with small populations.  For example, in biology, the analysis of growth curves for clonal cell cultures derived from single cells is attractive for several technical reasons, but growth curves are likely to be very difficult to interpret with a continuous, deterministic modelling framework.  This is because during the first several population doublings, the system is discrete (low integer numbers of cells) and unmodelled environmental variability and cell-to-cell heterogeneity are likely to cause strongly stochastic effects on cell division.</p>
	
	<h2>Introduction to the logistic model</h2>
	
	 <p>The <a href="http://en.wikipedia.org/wiki/Logistic_function#In_ecology:_modeling_population_growth">logistic model</a> of population dynamics was proposed by <a href="http://en.wikipedia.org/wiki/Pierre_Fran%C3%A7ois_Verhulst">Verhulst</a> in 1838 as an improvement to the <a href="http://en.wikipedia.org/wiki/Malthusian_growth_model">Malthusian</a> exponential model for describing population growth.  The logistic model is a very simple mechanistic model that can be applied to a wide range of population types, including ecological populations or human demographics, but I am mostly interested in using the logistic model to describe the growth of clonal cell populations growing <i>in vitro</i></a>.</p>
	 
	 <p>The continuous, deterministic, exponential growth model of a population, or culture (of size $N$) of dividing cells with an intrinsic growth rate $r$ can be written as an ordinary differential equation:</p>
	 	
	$\frac{dN}{dt} = r N$
	
	<p>If we assume that the culture was inoculated with $N_0$ cells (the initial condition for the population size), we can easily solve the above ODE to give an analytical solution for the dynamics of population size according to the exponential model:</p>
	
	$N(t)=N_0 e^{r t}$
	
	<p>There are several strong assumptions embedded in this model: 
	<ol>
	<li>Growth is never inhibited by any density effects (i.e. the population never runs out of space or resources).  This assumption is only valid during the early stages of population growth.
	<li>Population size is continuous (i.e. a real number, rather than an integer).  This assumption is approximately correct for large populations.
	<li>All members of the population have the same growth rate.  For heterogeneous, biological populations, growth rates are likely to vary slightly within populations (e.g. from cell to cell).</li>
	<li>Growth rate is constant with time.  Even if environmental conditions (on which expected growth rates depend), like temperature for example, are kept constant, actual rates of division may fluctuate with time.  However, for a sufficiently large population, average growth rate will describe population-level dynamics well.</li>
	</ol>
	</p>
	
	<p>The continuous, deterministic logistic model eliminates the need to make the first assumption above by incorporating density-dependent growth inhibition.  It introduces a new concept: population carrying capacity, described by a new model parameter $K$.  Carrying capacity is the maximum population size that can be supported (given, say, environmental nutrient constraints, or space constraints).  We can think of the logistic model ODE (below) as being the same as the exponential model ODE, but with growth rate multiplied by an inhibition term.  The value of the inhibition term is approximately 1 when the population is "small" (e.g. when $N << K$), but as $N$ approaches $K$, the inhibition term (and therefore the population growth rate) approaches zero asymptotically.  Population size $N$ approaches carrying capacity $K$ asymptotically as $N = K$ is a stable, attractive fixed point for the system.</p>
	
	$\frac{dN}{dt} = r N\left ( 1-\frac{N}{K} \right )$

	<p>The logistic model ODE has an analytical solution.  Solving this simple ODE is a good exercise in integration by parts.</p>
	
	$N(t) = \frac{K N_0 e^{rt}}{K + N_0 \left( e^{rt} - 1\right)}$
	
	<br></br>
	
	<h2>An algorithm for discrete, stochastic simulation</h2>
	
	<p>In this section $N$ will be an integer, representing number of cells.  To carry out discrete event simulation of the logistic model, we need to be able to write down the hazard function for the probability that a cell divides in an infinitesimally small window of time about time $t$.  The hazard is constant between divisions and modelling it will allow us to estimate the time between cell divisions.  We will update cell number by simulating the time between cell divisions, incrementing the population size by one at each division and continuing until a termination condition is met.  In this case, we will terminate simulation when the population reaches its carrying capacity.</p>
	
	<p><a href="http://dx.doi.org/10.1016%2F0021-9991%2876%2990041-3">Gillespie (1977)</a> shows us how to use a wide range of hazard functions derived from zeroth, first or second order rate expressions for reactions in a chemical network.  It is possible to derive the logistic equation assuming cells consume nutrients by mass action reaction kinetics (I'll write another post about this soon), and this makes it more clear why the carrying capacity $K$ should be included in the hazard function.  For now, let us accept that the RHS of the logistic model ODE above is an appropriate hazard function for discrete stochastic simulation, describing the dependance of the probability of a cell division occuring on the number of cells in the population and on the model parameters.</p>
	
	$h(N,r,K) = r N\left ( 1-\frac{N}{K} \right )$
	
	<p>Starting at $t = 0$ and given an initial population size (the number of cells in the culture inoculum $N(0) = N_0$) we can simulate the time to the next cell division, given the above hazard function, by sampling from an exponential distribution:</p>
	
	$\delta t \sim{ Exp(h(N,r,K))}$
	
	<p>Then we can update the simulated time and population size computationally:</p>
	
	$t = t + \delta t\\
	N = N + 1$

	<p>We repeat these two steps until the population has reached its carrying capacity, i.e. while $N < K$.  Ensembles of simulated realisations from this model are shown in the plot below.</p>
	
	<IMG src="DiscreteStochasticLogistic/Simulations1.png" title="Logistic model simulations">
	<p style="font-size: 75%;"><b>Logistic model simulations</b>  100 discrete stochastic simulations from the logisitic model of growth from an inoculum of one cell ($N_0 = 1$) to a carrying capacity of 100 cells ($K = 100$) for a slow growing strain (pink, $r = 3$) and a fast-growing strain (grey, $r = 10$).  Deterministic simulations using the same parameter values are overlaid in red and black respectively.</b>
	
	<p>There is one feature unique to the logistic model that allows us to carry out relatively efficient simulation: we can calculate the total number of events (e.g. cell divisions) which will occur <i>a priori</i> ($K-N_0$).  This allows us to generate all the random numbers required for stochastic simulation at once, which in turn allows vectorised calls to random number generators.  Generating random numbers with vectorised calls is useful for carrying out simulations in high-level programming languages such as <a href="http://www.r-project.org/">R</a> or <a href="http://www.python.org/">Python</a> where vectorised operations are many times faster than equivalent for loops.  The R function below is quite fast, simulating a cell population with a carrying capacity of 1.6 million cells (corresponding to a realistic pinned yeast culture growing on CSM solid agar for example) in about half a second.</p>
	
<div style="overflow:auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family:monospace;">simCells=<a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>K<span style="color: #339933;">,</span>r<span style="color: #339933;">,</span>N0<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
	<span style="color: #666666; font-style: italic;"># Unusually, for this model, we know the number of events a priori</span>
	eventNo=K<span style="">-</span>N0
	<span style="color: #666666; font-style: italic;"># So we can just generate all required random numbers (quickly) in one go</span>
	unifs=<a href="http://inside-r.org/r-doc/stats/runif"><span style="color: #003399; font-weight: bold;">runif</span></a><span style="color: #009900;">&#40;</span>eventNo<span style="color: #009900;">&#41;</span>
	<span style="color: #666666; font-style: italic;"># Every event produces one cell and consumes one unit of nutrients</span>
	clist=<span style="color: #009900;">&#40;</span>N0<span style="">+</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="">:</span>K
	<span style="color: #666666; font-style: italic;"># Simulate time between events by generating </span>
        <span style="color: #666666; font-style: italic;"># exponential random numbers using the inversion method</span>
	dts=<span style="">-</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span>unifs<span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #009900;">&#40;</span>r<span style="">*</span>clist<span style="">*</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span>clist<span style="">/</span>K<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
	<a href="http://inside-r.org/r-doc/base/return"><span style="color: #003399; font-weight: bold;">return</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/cumsum"><span style="color: #003399; font-weight: bold;">cumsum</span></a><span style="color: #009900;">&#40;</span>dts<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>N0<span style="color: #339933;">,</span>clist<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span></pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>

<p>The code snippet above works by generating $K-N_0$ $U(0,1)$ random numbers and the list of cell numbers ($N$) present after each division event, using $N$, $r$ and $K$ to calculate the hazard of division for each value of $N$ and finally, using the <a href="http://en.wikipedia.org/wiki/Inverse_transform_sampling">inversion method</a> to generate a sample from the exponential distribution with rate parameter equal to the hazard.</p>

<h2>Conclusion</h2>

<p>I'm particularly interested in applying this simple function to understanding population growth curves initiated from single cells.  The plot above demonstrates the very wide range of different growth curves that this model produces for simulated cultures inoculated from a single cell.  In particular, slow growing strains, whose probability of division is lower at a given time, are affected strongly by discrete stochastic effects during the first few divisions.  This results in the much wider spread of pink curves than grey in the above figure.  The plot above suggests that experimental observations of growth curves arising from cultures inoculated by single cells are likely to have a high degree of intrinsic stochasticity.  Fitting a deterministic model to experimentally observed replicate growth curves is likely to give an artificially high estimate of the variability of the growth rate parameter $r$ in this case.</p>

<p>This function is also reasonably efficient and is unusual in that it is fully vectorised.  This allows exploration of discrete stochastic logistic model simulations in high-level languages such as R and Python, allowing rapid prototyping of inference and simulation workflows for example.</p>

</article>
</article>

<article>

<h1>Redesign</h1><time datetime="2012-06-24T20:00:00Z">20:00 Sunday 24th June 2012</time>

<p>I'm currently redesigning <a href="http://cnr.lwlss.net/">this page</a> to take advantage of newer web technologies that I'm interested in, such as: HTML5, Javascript, CSS3, Python, Apache and Git.  The new design is a static website built from flat files and folders and should be flexible enough to allow me to enjoy writing things online again.  The previous incarnation of these pages was a Drupal installation that I set up and hosted myself.  In the past few years I have found Drupal to be extremely restrictive.  In particular it limits the way in which I can embed content in articles I write.  It was not the same as writing HTML directly.  I've finally gotten round to eliminating Drupal, and I suspect that I would be similarly unhappy with Wordpress.  For the moment, here is a list of archival articles from my old blog (which was built using PHP and Drupal, neither of which I am interested in any longer).  I've converted the articles to raw HTML which I hope to format nicely using the technologies listed above at some point.  URLs should be preserved from the Drupal site, so old links are preserved and will be found at the same location by search engines.  The box at the bottom of this page is for a custom search of the articles on this site.
</p>

<p>Things left to do include: writing some nice CSS to pretty this up, designing a layout for the front page, automatic construction of front page and RSS feed upon addition of new articles, sticking code for automation on GitHub.</p>

<ul><li><a href="./Skye2012/">A trip to Skye</a> Monday 9th April 2012</li><li><a href="./AllendaleWalk/">Walk in Allendale</a> Monday 12th March 2012</li><li><a href="./MovConversion/">Converting .mov files to .avi in Microsoft Windows</a> Sunday 8th January 2012</li><li><a href="./AnneDoyle/">Anne Doyle</a> Sunday 8th January 2012</li><li><a href="./FOA10K2011/">Fields of Athenry 10k - 2011</a> Thursday 29th December 2011</li><li><a href="./MichaelD/">Michael D and The Mountain</a> Sunday 30th October 2011</li><li><a href="./ShortWalksNorthumberland/">Short walks in Northumberland</a> Saturday 1st October 2011</li><li><a href="./CircleObjectivesPython/">Testing optimisation algorithms: Part IV - Objective function and optimisation in Python</a> Wednesday 28th September 2011</li><li><a href="./GlobOptR/">Testing optimisation algorithms: Part III - Global optimisation in R</a> Sunday 18th September 2011</li><li><a href="./CirclePackingObjective/">Testing optimisation algorithms: Part I - A circle packing objective function</a> Sunday 4th September 2011</li><li><a href="./Oscillations/">Oscillations</a> Wednesday 31st August 2011</li><li><a href="./GarminR/">Parsing and analysis of GPX files in R</a> Saturday 14th May 2011</li><li><a href="./PlantScan/">Scanning Plant Tissue</a> Saturday 14th May 2011</li><li><a href="./QFAPLoS/">Quantitative Fitness Analysis and the Telomere Cap</a> Thursday 7th April 2011</li><li><a href="./RealData/">Real datasets with R - 10k finish times</a> Tuesday 1st February 2011</li><li><a href="./MoreData/">More data</a> Saturday 29th January 2011</li><li><a href="./ICSB2010/">11th International Conference on Systems Biology, Edinburgh 2010</a> Friday 15th October 2010</li><li><a href="./AustrianHoliday/">Austrian-Italian holiday</a> Sunday 5th September 2010</li><li><a href="./Islamophobia/">Islamophobia</a> Saturday 29th May 2010</li><li><a href="./Colonyzer/">Colonyzer: automated quantification of micro-organism growth characteristics on solid agar</a> Friday 28th May 2010</li><li><a href="./ScientificPython/">Python for Scientists</a> Sunday 18th April 2010</li><li><a href="./AmieKnit/">Amie knits gorillas</a> Tuesday 23rd February 2010</li><li><a href="./SenescenceBiomarkers/">Quantitative assessment of markers for cell senescence</a> Tuesday 2nd February 2010</li><li><a href="./DavidJones/">Daedalus of DREADCO.</a> Saturday 23rd January 2010</li><li><a href="./CloseEncounters/">CloseEncounters</a> Tuesday 12th January 2010</li><li><a href="./CaliBayesBASIS/">CaliBayes and BASIS: integrated tools for the calibration, simulation and storage of biological models.</a> Friday 8th January 2010</li><li><a href="./ZoomRandom/">Zoom on a Random Walk</a> Sunday 6th December 2009</li><li><a href="./RandomWalks/">Random Walks</a> Thursday 26th November 2009</li><li><a href="./RasterArchimedes/">Rasterizing Archimedes Spirals</a> Saturday 14th November 2009</li><li><a href="./bikehike/">Elevation</a> Saturday 7th November 2009</li><li><a href="./ZombieKT/">ZombieKT</a> Tuesday 20th October 2009</li><li><a href="./Mercantour2/">Parc Mercantour Part Deux</a> Sunday 11th October 2009</li><li><a href="./DinosaurPanel2/">Dinosaurs!</a> Friday 31st July 2009</li><li><a href="./GreetingsUsers/">In Tron</a> Saturday 27th June 2009</li><li><a href="./Runs/">Running</a> Monday 12th January 2009</li><li><a href="./TomWaitsEdinburgh/">Tom Waits</a> Monday 28th July 2008</li><li><a href="./TetrisCompletion/">Tetris</a> Sunday 27th July 2008</li><li><a href="./Clix2Moovies/">IRiver Clix 2 Videos</a> Monday 14th July 2008</li><li><a href="./Timelapse/">Timelapse and Timeslice</a> Sunday 13th July 2008</li><li><a href="./CPTYLGM08/">Cath &amp; Phil Tyler playing at the Green Man Festival 2008</a> Sunday 13th July 2008</li><li><a href="./Illuminators/">Illuminators</a> Monday 16th June 2008</li><li><a href="./HairBunnies/">Hair Bunnies</a> Saturday 31st May 2008</li><li><a href="./NOFISS/">NoFi Night at the S&amp;S</a> Wednesday 14th May 2008</li><li><a href="./JJP15/">JJP15</a> Wednesday 14th May 2008</li><li><a href="./PhotoAndVideoPages/">Using my online resources</a> Wednesday 14th May 2008</li><li><a href="./Photovinyl/">Photovinyl</a> Saturday 8th March 2008</li><li><a href="./MIDIO/">MIDIO</a> Tuesday 22nd January 2008</li><li><a href="./GalwayMummers/">Galway Mummers</a> Thursday 10th January 2008</li><li><a href="./MuteP2PWeb2/">InfoEnclosure2.0</a> Monday 26th November 2007</li><li><a href="./Jinglebrass/">The best christmas music ever</a> Saturday 24th November 2007</li><li><a href="./BiometricID/">Biometric ID cards</a> Saturday 24th November 2007</li><li><a href="./LegoBlisters/">Lego Blisters</a> Saturday 29th September 2007</li><li><a href="./AndrewBurton/">Bricks And Bees</a> Monday 10th September 2007</li><li><a href="./OutdoorScreenings/">Screenings</a> Monday 3rd September 2007</li><li><a href="./Mercantour/">Parc du Mercantour</a> Tuesday 28th August 2007</li><li><a href="./CCAttrib/">Creative Commons is Pretty Cooo</a> Wednesday 22nd August 2007</li><li><a href="./GreenMan07/">Green Man Festival 2007</a> Tuesday 21st August 2007</li><li><a href="./EasyjetBikes/">EasyJet don't do bicycles</a> Tuesday 21st August 2007</li><li><a href="./AnuRednile/">Rednile</a> Saturday 11th August 2007</li><li><a href="./Paintball/">Paintball</a> Sunday 5th August 2007</li><li><a href="./Ants/">Ants</a> Sunday 5th August 2007</li><li><a href="./MathMLDrupal/">I wonder does MathML work...</a> Monday 16th July 2007</li><li><a href="./flickrgft/">flickrgft</a> Sunday 15th July 2007</li><li><a href="./1DMoovies/">One Dimensional Movies</a> Sunday 15th July 2007</li></ul>

<div id="cse" style="width: 25%;">Loading</div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript"> 
  google.load('search', '1', {language : 'en', style : google.loader.themes.MINIMALIST});
  google.setOnLoadCallback(function() {
    var customSearchOptions = {};  var customSearchControl = new google.search.CustomSearchControl(
      '006329004553662584378:az6bswtkuhq', customSearchOptions);
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    customSearchControl.draw('cse');
  }, true);
</script>

</article>

</body>
</html>